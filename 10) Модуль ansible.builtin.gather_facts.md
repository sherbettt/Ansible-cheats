[ansible.builtin.gather_facts module – Gathers facts about remote hosts](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/gather_facts_module.html#ansible-collections-ansible-builtin-gather-facts-module)

### Модуль **ansible.builtin.gather_facts**: Сбор фактов о удалённых узлах

Модуль **gather_facts** является частью ядра Ansible (`ansible-core`) и автоматически включается во все установки Ansible. Этот модуль собирает полезные переменные о состоянии удаленных узлов, которые могут использоваться в плейбуках и сценариях автоматизации.

#### Основные особенности:
- По умолчанию этот модуль вызывает стандартный модуль сбора фактов — **ansible.builtin.setup**, который получает базовую информацию о хостах.
- Используется автоматически плейбуками перед выполнением любых задач, чтобы собрать данные о целевых машинах.
- Можно запускать вручную командой `/usr/bin/ansible`, чтобы проверить доступные переменные на конкретном хосте.

#### Параметры:
- **Параллельное выполнение модулей**: позволяет настроить параллельный сбор данных от нескольких модулей, обеспечивая гарантированный порядок слияния результатов, однако производительность может снизиться.

#### Атрибуты:
- Имеет соответствующую плаги́н-плагин для расширенной обработки данных на контроллере.
- Поддерживает работу в режиме проверки (**check_mode**) без изменения целевой системы.
- Может возвращать подробную информацию о произошедших изменениях или потенциальных изменениях в режиме проверки (**diff mode**).

#### Примеры использования:
```bash
# Показать факты обо всех хостах и сохранить их индексированные по имени хоста в каталоге /tmp/facts
ansible all -m ansible.builtin.gather_facts --tree /tmp/facts
```

Пример использования модуля **gather_facts** внутри плейбука Ansible выглядит следующим образом:

```yaml
---
- name: Gather Facts Playbook Example
  hosts: all
  tasks:
    - name: Collect information about managed nodes
      ansible.builtin.gather_facts:
    
    - name: Print collected facts
      debug:
        var: ansible_facts
```

### Описание примера:

1. **hosts:**  
   Плейбук выполняется на всех указанных узлах (*all*). Вы можете ограничить выборкой конкретных групп серверов или отдельных машин.
   
2. **tasks:**  
   Первая задача выполняет фактический сбор информации с использованием встроенного модуля **gather_facts**.  
   Вторая задача выводит собранные факты с помощью модуля **debug**.

3. **ansible_facts:**  
   Это специальная структура данных, содержащая всю собранную информацию о целевом узле, такую как операционная система, версия ОС, сетевые интерфейсы, диски и многое другое.

Таким образом, модуль **gather_facts** помогает собирать важные метаданные о ваших серверах и упрощает написание динамических и адаптивных плейбуков Ansible.
