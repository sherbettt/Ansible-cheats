 [Collection Index](https://docs.ansible.com/ansible/latest/collections/) ->  [ansible.builtin.dnf module](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/dnf_module.html#ansible-collections-ansible-builtin-dnf-module)


### Модуль ansible.builtin.dnf — Управление пакетами с использованием менеджера пакетов dnf

Этот модуль является частью ядра Ansible (`ansible-core`) и включен во все установки Ansible. Обычно можно использовать сокращённое имя модуля `dnf`, хотя рекомендуется использовать полное квалифицированное имя коллекции `ansible.builtin.dnf`. Это облегчает связь с документацией модуля и предотвращает конфликты с другими коллекциями, имеющими одноимённые модули.

Модуль управляет пакетами и группами пакетов с помощью диспетчера пакетов **dnf**, позволяя устанавливать, обновлять, удалять пакеты и группы пакетов.

#### Основные возможности:
- Установка, обновление и удаление отдельных пакетов и групп пакетов.
- Работа с репозиториями и управление зависимостями.
- Поддержка сложных условий для установки конкретных версий пакетов.
- Интеграция с различными стратегиями исполнения задач Ansible.

## Параметры модуля

Ниже приведены ключевые параметры модуля `ansible.builtin.dnf` с пояснениями:

- **allow_downgrade**: Разрешить установку указанной версии пакета даже если уже установлена более новая версия.
- **disable_gpg_check**: Отключить проверку подписи GPG пакетов перед установкой.
- **disablerepo**: Список репозиториев, которые будут отключены при выполнении операции.
- **enable_plugin**: Включить определённый plug-in dnf.
- **enablerepo**: Активирует дополнительные репозитории для данной транзакции.
- **exclude**: Пакеты, исключаемые из операций.
- **forcearch**: Принуждает установить архитектуру конкретного пакета.
- **list_exclude**: Дополнительная возможность исключить пакеты из списка установленных.
- **name**: Имя пакета или спецификатор имени и версии пакета (например, `httpd>=2.4`).
- **releasever**: Альтернативная версия выпуска системы, от которой будут устанавливаться пакеты.
- **skip_broken**: Пропускать пакеты с ошибочными зависимостями без вывода ошибок.
- **sslverify**: Проверять сертификат сервера репозитория.
- **state**: Желаемое состояние пакета (`present`, `latest`, `absent`).
- **timeout**: Время ожидания освобождения блокировки dnf.
- **update_cache**: Обновляет кэш метаданных перед выполнением команды.
- **validate_certs**: Использовать SSL-валидацию сертификатов при загрузке RPM-пакетов.
- **backend**: Выбор движка (по умолчанию используется встроенный в dnf механизм).

## Примеры использования

```yaml
- name: Установить последнюю версию Apache
  ansible.builtin.dnf:
    name: httpd
    state: latest

- name: Установить Apache >= 2.4
  ansible.builtin.dnf:
    name: httpd >= 2.4
    state: present

- name: Удалить пакет Apache
  ansible.builtin.dnf:
    name: httpd
    state: absent

- name: Обновить все установленные пакеты
  ansible.builtin.dnf:
    name: '*'
    state: latest

- name: Убедитесь, что установлен веб-сервер, соответствующий вашей системе
  ansible.builtin.dnf:
    name:
      - httpd
      - nginx
    state: latest
    update_only: yes

- name: Установить RPM-файл Nginx из удалённого репозитория
  ansible.builtin.dnf:
    name: 'http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm'
    state: present

- name: Установить группу пакетов Development Tools
  ansible.builtin.dnf:
    name: '@Development tools'
    state: present

- name: Автоматически удалить неиспользуемые зависимости
  ansible.builtin.dnf:
    autoremove: yes

- name: Установить PostgreSQL-модуль с указанным потоком и профилем
  ansible.builtin.dnf:
    name: '@postgresql:9.6/client'
    state: present
```

Эти примеры демонстрируют различные сценарии управления пакетами с использованием модуля `ansible.builtin.dnf`: установка конкретной версии, работа с несколькими пакетами одновременно, использование внешних источников и специализированных групп пакетов.

Таким образом, этот модуль позволяет эффективно управлять состоянием пакетов и зависимостей в системах Linux с поддержкой dnf, обеспечивая гибкость и совместимость с существующими инфраструктурами Ansible.
